define(["jquery","handlebars","truthy","main","wheelprogress","insecureToSecure","nodecimals","cms"],function(e,t,a,n,o,r,s){if("true"===e("#registeredForEvent").text()?e({rfl:"#nav .col-sm-3:last-child, .header-bottom-mobile .col-xs-4:last-child,.header-bottom-mobile .col-xs-6:last-child",msabc:"#nav .col-sm-3:last-child, .header-bottom-mobile .col-xs-4:last-child,.header-bottom-mobile .col-xs-6:last-child",rmwp:"#local-nav .col-sm-4:first, .header-bottom-mobile .col-xs-6:last-child",active:"#nav .col-sm-3:last-child, .header-bottom-mobile .col-xs-4:last-child,.header-bottom-mobile .col-xs-6:last-child"}[window.product]).addClass("active"):"false"===e("#registeredForEvent").text()&&"rmwp"===window.product&&e("#local-nav .col-sm-4:first, .header-bottom-mobile .col-xs-6:last-child").addClass("active"),function(){var t,i,a=e("#photos").data("flickr-id")+"";if(!a)return;a.indexOf("flickrId")>-1&&(i=a.split("flickrId=")[1].split(",")[0]);if("active"===n.themeGroup&&a.indexOf("instagram=")>-1){var o=a.match(/instagram=.*?$/)[0];(o=o.indexOf(",")>-1?o.split(/instagram=(.*?\,+)/)[1].replace(",",""):o.split(/instagram=(.*)/)[1])&&o.length&&(a=o)}else if("active"===n.themeGroup&&-1===a.indexOf("instagram=")&&-1===a.indexOf("instagr.am")&&-1===a.indexOf("@"))return;if(a.indexOf("instagram.com")>-1||a.indexOf("instagr.am")>-1)if(a.indexOf(",")>-1){var r=a.indexOf(",");a="instagram:"+a.slice(a.indexOf("/p/")+3,r).replace("/","")}else a="instagram:"+a.slice(a.indexOf("/p/")+3,a.length).replace("/","");a.toLowerCase().indexOf("instagram.com/p/")>-1&&(t="https://www.instagr.am/p/"+a.substring(10,a.length)+"/");t?e.ajax({url:"https://api.instagram.com/oembed?url="+t,type:"GET",success:function(t){e("#photos").prepend(t.html).addClass("instagram");var i=e("#photos").data("flickr-id");-1===i.indexOf("flickrId")?(e("#photos img").remove(),e(".picture_frame").addClass("hidden")):e(".picture_frame").removeClass("hidden")},error:function(t){var a=e("#photos").data("flickr-id");a.indexOf("flickrId")>-1?((i=a.split("flickrId=")[1].split(",")[0])&&e("body").append(e('<script src="https://api.flickr.com/services/feeds/photos_public.gne?id='+i+'&format=json">')),e(".picture_frame").removeClass("hidden")):e(".picture_frame").addClass("hidden")}}):i&&e("body").append(e('<script src="https://api.flickr.com/services/feeds/photos_public.gne?id='+i+'&format=json">'))}(),e("#progress_wheel .full").css("transition","stroke-dashoffset "+Math.ceil(e("#progress-container").data("raised")/40)+".5s ease-out"),o.setProgress(e("#progress-container").data("raised")),e(".list-name-container").each(function(){var t=e(this);t.prepend(t.find(".display-name"))}),-1!=e("#divfridlist").text().indexOf(n.frid)){var l=e("#page_content").find("h1.main-event-title").text();-1!=l.toLowerCase().indexOf("disney world marathon")&&(l=l.replace("WORLD","WORLDÂ®"),e("#page_content h1.main-event-title").text(l))}n.config.entry.hideTopFundraiserEventSections&&(e("#top-teams-list .indicator-list-row").length<=0&&e("#top-teams").hide(),e("#top-part-list .indicator-list-row ").length<=0&&e("#top-parts").hide(),e("#top-companies-list .TopRow").length<=0&&e("#top-companies").hide()),n.config.entry.topFundraiserHideCents&&e(".fundraising-container .VSAmount").each(function(){e(this).text(s.formatAmountNoDecimals(e(this).text()))}),n.config.entry.noDecimals?e("#top-companies-list .TopAmount").each(function(){e(this).text(s.formatAmountNoDecimals(e(this).text())).addClass("list-value-container")}):e("#top-companies-list .TopAmount").each(function(){e(this).text(e(this).text().replace(/\(|\)/g,"").replace(/\.\d\d/,"")).addClass("list-value-container")}),e("#top-companies-list").length&&(e("#top-companies-list .TopNumber").remove(),e("#top-companies-list .TopBadge").each(function(){e(this).appendTo(e(this).next()).addClass("badge-icon")}),e("#top-companies-list .TopName").addClass("list-name-container"),e("#top-companies-list").html(e("#top-companies-list").html().replace(/&nbsp;/g,"")));var d,c,m,h=e("#days-to-event").val();if(h<=7&&h>=0&&n.config.eventDetailsModal){if("es_US"===n.locale){var p=e("#event-details-modal #schedule #info").text().replace(/Registration:/,'<strong>Inscripci&oacute;n:</strong><br class="visible-xs">'),f=e("#event-details-modal #schedule #info + p").text().replace(/Walk:/,'<strong>Caminar:</strong><br class="visible-xs">');e("#event-details-modal #schedule #info + p").html(f),e("#event-details-modal #schedule #info").html(p)}else{var u=e("#event-details-modal #schedule #info").text().replace(/Registration:/,'<strong>Registration:</strong><br class="visible-xs">'),v=e("#event-details-modal #schedule #info + p").text().replace(/Walk:/,'<strong>Walk:</strong><br class="visible-xs">');e("#event-details-modal #schedule #info + p").html(v),e("#event-details-modal #schedule #info").html(u)}e(".event-details-modal").modal("show")}function g(e,t){for(var i=e.split(","),a=void 0,o=0;o<i.length;o++){var r=new RegExp(t+"=.*?$"),s=i[o].match(r);if(s&&s[0]){s=s[0];var l=new RegExp(t+"=(.*?.+)");if(s.indexOf("youtu")>-1&&(youtubeId=s.match(/(\/embed\/|watch\?v=|youtube.com\/v\/|youtu.be\/)([\S]+?)([\&\?#]|$)/),n.truthy(youtubeId)&&n.truthy(youtubeId[2]))){a=youtubeId[2]||!1;break}if(s.indexOf("twitch")>-1){var d=s.split("twitch=")[1],c=d.lastIndexOf("/")+1;a=d.slice(c,d.length);break}if(s.indexOf("igIcon")>-1){a=s.split("igIcon=")[1];break}if(s.indexOf(",")>-1)s=s.split(l)[1].replace(",","");else{var m=new RegExp(t+"=(.*)/");s=s.split(m)[1]}if(s&&s.length){a=s;break}}}return a||!1}85318==n.frid&&e(".sponsors-container").remove(),(m=function(){var t=e("#photos").data("flickr-id")+"",i={};if(!t)return!1;var a=g(t,"fbVideo"),n=g(t,"youtubeVideo"),o=g(t,"twitch"),r=g(t,"igIcon");return a&&(i.fbVideo=a),n&&(i.youtube=n),o&&(i.twitch=o),r&&(i.instagram=r,e(".instagram_share").attr("href",r)),i}())&&(m.fbVideo?(d=m.fbVideo,c='<div class="fb-video" data-href="'+d+'" data-width="720" data-show-text="false">\n      <div class="fb-xfbml-parse-ignore">\n        <blockquote cite="'+d+'">\n          <a href="'+d+'">How to Share With Just Friends</a>\n          <p>How to share with just friends.</p>\n        </blockquote>\n      </div>\n    </div>',e(".livestream").append(c).removeClass("hidden").addClass("fb-streaming"),window.FB.XFBML.parse(document.getElementById("page_content"))):m.youtube?function(t){var i='<iframe width="720" height="500" src="https://www.youtube.com/embed/'+t+'" frameborder="0" allow="accelerometer; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>';e(".livestream").append(i).removeClass("hidden").addClass("fb-streaming")}(m.youtube):m.twitch&&function(t){var i='<iframe src="https://player.twitch.tv/?channel='+t+"&parent="+document.location.hostname+'&autoplay=false" frameborder="0" allowfullscreen="true" scrolling="no" height="500" width="720"></iframe>';e(".livestream").append(i).removeClass("hidden").addClass("twitch-streaming")}(m.twitch)),n.config.entry.textUpdates&&e("#sms-modal-link").on("click tap",function(){if(e("#sms-key").text().indexOf(",")>-1)e("#sms-key").text().trim().split(",")[0];else e("#sms-key").text()}),n.config.entry.wrapIcons&&(e(".vScrollList li .VSBadge").each(function(){e(this).wrap("<div class='icon-container'></div>")}),e(".vScrollList li .VSName").each(function(){e(this).wrap("<div class='name-container'></div>")}),e(".vScrollList li .VSAmount").each(function(){e(this).wrap("<div class='amount-container'></div>")}),e(".vScrollList li").each(function(){e(this).prepend("<div class='left-section'></div>"),e(this).append("<div class='right-section'></div>"),e(this).find(".left-section").append(e(this).find(".icon-container")).append(e(this).find(".name-container")),e(this).find(".right-section").append(e(this).find(".amount-container"))}));if(n.config.entry.validateCoordinatorPhone&&function(){var t=e("#coordinator-phone-link").attr("href");if(t){var i="tel:"+t.replace(/\D/g,"");e("#coordinator-phone-link").attr("href",i)}}(),document.location.hostname.match("tacsdev")&&(e("#all-announcements-link").attr("href",e("#announcements-dev").attr("href")),e("#optional_event_summary").data("content-url",e("#announcements-dev").attr("href")),e("#announcements > .col-sm-4").remove()),n.config.cleanDollarDecimals&&(e(".value").text(e(".value").text().replace(/\.\d\d/,"")),e(".dollars").text(e(".dollars").text().replace(/\.\d\d/,""))),n.truthy(n.query.company)&&e("#entry-join-walk").length){var w=e("#entry-join-walk").attr("href")+"&company="+n.query.company;e(".reg-intent").attr("href",w)}e(function(){function t(){var t=0;e("#info_row .col-sm-4 .event-info").each(function(){e(this).height()>t&&(t=e(this).height())}),e(window).width()>767&&t>200&&t<=300&&(e("#info_row .col-sm-4 .event-info").height(""),e("#info_row .col-sm-4 .event-info").height(t))}e(window).resize(function(){n.waitForFinalEvent(function(){t()},500,"adjust_height_on_search_results")}),t();var i=e("#event-follow p.bottom").text();i.length>0&&e("#event-follow p.bottom").html("<a class='link-with-arrow' href='tel:"+i+"'>"+i+"</a>")}),function(){if(e(".all-announcements").removeClass("hidden-xs"),e(window).width()>767){t=0,e(".fundraising-container .top-list").each(function(){e(this).height()>t&&(t=e(this).height())}),t+=40,e(".fundraising-container .top-list").height(t)}var t;if(e(window).width()>991){setTimeout(function(){var t;t=0,e("#announcements .announcement-content").each(function(){e(this).height()>t&&(t=e(this).height())}),e("#announcements .announcement-content").height(t)},500)}}(),-1!=n.smsData.smsTest.indexOf("keyword")?n.smsData.smsTest.split(",").forEach(function(t){t.toLowerCase().indexOf("keyword")>-1&&(e(".sms-test").text(t.split("=")[1]),e(".keyword--update").text(t.split("=")[1]))}):(e(".sms-test").text("acs gen"),e(".keyword--update").text("acs gen")),e("#sms-modal-link").on("click tap",function(){var t=e("#sms-key").text();if(function(){return!0===matchMedia("only screen and (max-device-width: 1024px)").matches||!0===matchMedia("only screen and (max-device-width: 1366px) and (-webkit-min-device-pixel-ratio: 1.5)").matches}){var i=encodeURIComponent(t);t="<a class='keyword--update' href="+(n.iOS()?"sms:8776950095&body="+i:"sms:8776950095?body="+i)+">"+t+"</a>"}var a={id:"sms_content",title:"GET TEXT UPDATES ABOUT THIS EVENT",body:'Send <span  class="sms-test"> '+t+" </span> to <span> 877-695-0095 </span>"};n.generateModal(a)}),0===e(".event-luminaria").length&&e('a:contains("Luminaria")').hide();if(a.truthy(n.templates["leaderboard-template"]))n.templates["leaderboard-template"];else{var b=e("#leaderboard-template").html();b&&t.compile(b)}function x(e){return void 0===e||!e||0===e.length||null===e}function y(t,a,n,o){var r,s,l=void 0;l=Array.isArray(t)?t:t.results,s=void 0!==(r=o&&Array.isArray(o)?o:o.results)?r.length:0;var d,c=0;for(i=0;i<l.length;i++){for(k=0;k<s;k++)l[i].consId===r[k].consID&&(l[i].nationalTopPerformer=!0);if(!l[i].personalPagePrivate||"false"===l[i].personalPagePrivate)if("rmwp"===a.theme||"active"===a.themeGroup){if(!(x(l[i].personalPageUrl)||x(l[i].name.first)||x(l[i].name.last))){var m=C(l[i],a,n,c);e(".candidate-row").append(m),c++}}else{m=C(l[i],a,n,c);e(".candidate-row").append(m),c++}a.lazyLoadInstance.update()}a.truthy(a.config.entry.candidateGridLimit)&&t.total>a.config.entry.candidateGridLimit&&window.product.indexOf("active")>-1&&e("#ourmen .view-all-participants").removeClass("hidden"),e(".loader-holder:not('.donation')").hide(),a.truthy(a.config.levelHeightMen)&&(d=0,e(".personal.leaderboard-box").each(function(){e(this).height()>d&&(d=e(this).height())}),e(".personal.leaderboard-box").height(d+80)),a.cms.addSortHandlers(e(".cms-section > cms-buttons"))}function C(t,i,a,n){var o={},s="",l="";if(o.initials="",t.name&&t.name.first&&t.name.last){s=a.decode(t.name.first),l=a.decode(t.name.last);o.initials=t.name.first.substring(0,1).toUpperCase()+t.name.last.substring(0,1).toUpperCase()}return o.name=s+" "+l,o.consid=t.consId,o.amount="$"+(Math.floor(t.amountRaised/100)||"0").toString().replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,"),o.url=r.insecureUrlToSecure(t.personalPageUrl),o.company=t.pgData.company,o.img=t.pgData.img,"rmwp"===i.theme&&void 0!==n&&(o.rank=n+1),void 0!==t.nationalTopPerformer&&"rmwp"===i.theme&&(o.nationalTopPerformer=t.nationalTopPerformer),e(i.templates["leaderboard-template"](o))}n.config.entry.candidateGrid&&e(".candidate-grid").length&&require(["main","he"],function(t,i){!function t(i,a,n,o){e(".loader-holder:not('.donation')").show();var r=i.cmsapiurl+"/search/event/"+i.frid,s=i.cmsapiurl+"/top10Data";i.truthy(e("#candidate-limit"))&&e("#candidate-limit").val().indexOf("candidateGridLimit")>-1&&(candidateLimit=e("#candidate-limit").val().trim(),candidateLimit=candidateLimit.match(/candidateGridLimit=[\d][\d]/)[0].split(/candidateGridLimit=(\d\d)/)[1],i.truthy(candidateLimit)&&candidateLimit.length&&(o=candidateLimit,i.config.entry.candidateGridLimit=o)),i.truthy(o)&&o>40&&(o=40),i.truthy(o)&&(r+="?limit="+o),e.when(e.ajax({url:r,type:"GET",dataType:"json",header:{Accept:"application/json"}}),e.ajax({url:s,type:"GET",dataType:"json",header:{Accept:"application/json"}})).then(function(r,s){if(r&&!r[0].error)if(s&&!s[0].error){var l=e("#leaderboard-amount").val();r&&r[0]&&r[0].results&&l?(y(r[0].results.sort(function(e,t){return e.name.first.localeCompare(t.name.first)}),i,a,s[0]),r[0].results.length>=o&&e("#ourmen .view-all-participants").removeClass("hidden")):y(r[0],i,a,s[0])}else y(r[0],i,a);else i.truthy(n)?t(i,a,!1,o):e("#our-men, #active-leaderboard").addClass("hidden")},function(e){console.log("Error getting participants"),i.truthy(n)&&t(i,a,!1,o)})}(t,i,!0,t.config.entry.candidateGridLimit)});e("#top-companies .list-name-container a").each(function(){var t=e(this).attr("href");e(this).attr("href",n.trUrlToNational(t))}),e(".top-list:not(#top-companies-list) .indicator-link").each(function(){var t=e(this).attr("href");e(this).attr("href",r.insecureUrlToSecure(t))}),e("#top-part-list .indicator-link").attr("target","_blank")});