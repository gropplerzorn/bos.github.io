var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};define(["cms-custom-page-templates","jquery","main"],function(e,t,s){function a(e,a,c){if(void 0===e)e={sortOrder:t(".cms-custom-page-container .cms-sections > div").length,visible:!0,consId:parseInt(s.cons.cons_id),state:"unpublished",product:s.cmsGroup,eventId:s.frid,keyValues:{}};else{if(""!==e.keyValues)var o=JSON.parse(e.keyValues);else o={};o._id=e._id,o.state=e.state,o.eventId=e.eventId,o.sortOrder=e.sortOrder,e=o}var i;switch(void 0===a&&(a="simplePTemplate"),a){case"headTemplate":i="<span class='template-title'>Heading</span>";break;case"hrTemplate":i="<span class='template-title'>Horizontal Line</span>";break;case"simplePTemplate":i="<span class='template-title'>Single Column</span>";break;case"twoColPtemplate":i="<span class='template-title'>Double Column</span>";break;case"twoImageParagraphTemplate":i="<span class='template-title'>Double Image Column</span>";break;case"threeImageParagraphTemplate":i="<span class='template-title'>Triple Image Column</span>";break;case"threeColPTemplate":i="<span class='template-title'>Triple Column</span>";break;case"imagePtemplate":i="<span class='template-title'>Image &amp; Text</span>";break;case"heroImgTemplate":i="<span class='template-title'>Banner Image</span>";break;case"imgCaptionTemplate":i="<span class='template-title'>Image &amp; Caption</span>";break;case"pageTitleTemplate":i="<span class='template-title'>Page Title</span>";break;case"buttonTemplate":i="<span class='template-title'>Button</span>";break;case"sponsorGridTemplate":i="<span class='template-title'>Sponsor Grid</span>";break;case"button":i="<span class='template-title'>Clickable Button</span>";break;case"youtubeUrlTemplate":i="<span class='template-title'>Youtube Video</span>";break;case"googleCalendarTemplate":i="<span class='template-title'>Google Calendar</span>";break;case"topTeamsTemplate":i="<span class='template-title'>Top Teams</span>",s.cms.getTopTeams();break;case"volunteerTemplate":i="<span class='template-title'>Volunteer</span>"}"Sign Up"!==e.text&&"Start a team"!==e.text||void 0===s.cmssignupurl||(e.link=s.cmssignupurl,-1===s.cmssignupurl.indexOf("signup")&&(e.dataLogin="data-needs-login"));var r=t(s.cms.customPageTemplates[a](e)),m=t(s.customButtons(e));if(e.state,r.prepend(m),r.prepend(i),(r=s.cms.replaceTemplateTags(r)).find("label[for='publish']").on("click",function(){var e=t(this).parent().find("input");e.is(":checked")?e.prop("checked",!1):e.prop("checked",!0),window.appInsights.trackEvent("hide/show state of section "+t(this).parent().parent().parent().attr("data-section")+" with id "+t(this).parent().parent().parent().attr("data-id")+" was changed to "+(e.is(":checked")?"show":"hide")+" on "+s.frid+" on page "+(s.query&&s.query.name?s.query.name:"cms-"+s.page))}),t(".cms-custom-page-container .cms-sections").append(r),s.lazyLoadInstance.update(),t("#cms-flyout").length)n(e,r);else{var p=n.bind(!1,e,r);t("body").on("defaultHTMLAdded",p)}"sponsorGrid"===a&&s.resetLocalSponsors()}function n(e,a){_typeof("undefined"!==s.cms.superUser)&&s.cms.isEmc&&(t(".cms-file-list").append(t(s.cms.templates["cms-file-chooser-template"]({id:e._id||"new"}))),t("body").hasClass("cms-editing")&&(s.cms.createEditor(t(a).find(".editable")),t(".cms-view-edit").removeClass("hidden"),t(".cms-view-normal").addClass("hidden")),s.cms.updatePageSort(t(".cms-custom-page-container .cms-sections")),s.cms.addSortHandlers(t(".cms-custom-page-container .cms-section > .cms-buttons")))}"undefined"==typeof jq3&&(jq3=t),s.customButtons=e.customButtons,s.cms.customPageTemplates=e.customTemps;var c=function(e){if(!e)return!1;var t=void 0,a=void 0;return t=s.truthy(e.frid)?e.frid:s.frid,a=s.truthy(e.name)?e.name:s.query.name,s.cmsapiurl+"/page/name/"+a+"/"+t+"?frid="+s.frid};function o(e){if(!e)return!1;var a=c(e),n=function(e,t,a){if(s.truthy(a.pages[0]))i(a.pages[0]);else if(t.indexOf("/default")>-1&&(s.cms.isEmc||s.cms.superUser)){var n={state:"unpublished",eventId:s.frid,product:s.cmsGroup,sid:s.cookie.JSESSIONID,consId:s.cons.cons_id};s.query.name?(n.name=s.query.name,n.title=s.query.name):(n.name="cms-"+s.page,n.title="cms-"+s.page);var c=o.bind(!1,void 0,e);s.cms.savePage(n,c)}r(),void 0!==e&&e(a)}.bind(!1,e.callback,a);t.ajax({url:a,type:"GET",headers:{"Cache-Control":"no-cache"},success:n,error:function(e){}})}var i=function(e){!function(e){"default"!==e.eventId?"default"===e.eventId?t("body").attr({"data-v":e.__v}).addClass("cms-custom-page"):t("body").attr({"data-id":e._id,"data-v":e.__v}).addClass("cms-custom-page"):t("body").addClass("cms-custom-page-default").addClass("cms-custom-page")}(e);var n,c,o=t(".cms-custom-page-container");for(section in function(e){if(!t(".cms-custom-page.cms-sections").length){var a=t("<div class='cms-custom-page cms-sections'></div>");if(e.length)e.append(a);else{var n=t("<div class='cms-custom-page-container'></div>").append(a);"rmwp"===s.cmsGroup?t(".cms-custom-top").length?t(".cms-custom-top").after(n):t("#page_content").prepend(n):t("#page_content").append(n)}}}(o),e.sections.sort(function(e,t){return void 0===e.sortOrder||void 0===t.sortOrder?0:e.sortOrder<t.sortOrder?-1:1}),currentPageState=e.state,e.sections)a(n=e.sections[section],n.template);s.query.name&&"event-fundraising"===s.query.name&&(c=["Donate","Sign Up"],t("[data-section='button'] .cms-view-normal a").each(function(){t.inArray(this.textContent,c)>-1&&(this.target="")}));var i=setInterval(function(){_typeof("undefined"!==s.cms.supeUser)&&(clearInterval(i),s.cms.isEmc&&(s.cms.setupControls(),t(".cms-edit").on("click",function(){for(var e in t(".entry-pg .cms-custom-page-container .cms-sections, .cms-custom-page .cms-custom-page-container .cms-sections").after(t('<div class="add-section-container"><a class="cms-section-add-icon"><span class="add-icon">+</span><span>Add New Section</span></a></div>')),s.customPageTemplates=customTemps,s.customPageTemplates)if("images"!==e){var n={name:e,svg:" ",customClass:"cms-template"};templateContainer=t(s.cms.templates["cms-flyout-icon-template"](n)),templateContainer.on("click",function(){a(void 0,t(this).data("template")),t(".editable").addClass("editing"),s.cms.hideFlyout()}),t(".cms-flyout-content.cms-section-list .row").append(templateContainer)}require(["cms-section-imgs"],function(e){for(var s in e)t('.cms-template[data-template="'+s+'"] span').append(e[s])}),t(".cms-section-add-icon").on("click",function(){t("[data-section='sponsorGrid']").length?t(".cms-template img[alt='sponsorGrid']").parent().addClass("hidden"):t(".cms-template img[alt='sponsorGrid']").parent().removeClass("hidden"),s.cms.showFlyout("add-section")}),s.cms.createEditor(t(".editable:not(.su-editable)")),s.cms.updatePageSort(t(".cms-custom-page-container .cms-sections")),s.cms.addSortHandlers(t(".cms-custom-page-container .cms-section > .cms-buttons")),t("body").hasClass("cms-custom-page-default")&&(jq3(".cms-save").trigger("click"),t("body").removeClass("cms-custom-page-default")),t(".cms-view-edit").removeClass("hidden"),t(".cms-view-normal").addClass("hidden")})))},250)},r=function(){if("event-details"!==s.query.name||"msabc"!==s.cmsGroup)return!1;t(".fr-title.sect-title").remove();var e=s.eventName,a='<span class="fr-title sect-title event-details-sect-title">      <strong><a class="event-link" href="TR?pg=entry&fr_id='+s.frid+'">';e.toLowerCase().indexOf("making strides of")>-1?a+=e+"</a></strong></span>":a+="Making Strides of"+e+"</a></strong></span>",t(".cms-heading-section:first").before(a)};return o});