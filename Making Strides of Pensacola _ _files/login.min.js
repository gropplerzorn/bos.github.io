define(["jquery"],function(e){window.THM=window.THM||{};var t=window.THM;function n(){return new Date(Date.now()-864e5)}function o(n){var o={msabc:{theme:"MSABC",securityCode:"MakingStrides_"},rfl:{theme:"RFL",securityCode:"Relay_"},rmwp:{theme:"RMWP",securityCode:"RealMen_"}};(n=n.replace(/%3B/i,";").replace(/%3D/i,"=")).indexOf(";jsessionid")>-1&&(n=n.replace(/;jsessionid=\d+\.\S+\?/gi,"?").replace(/&NONCE_TOKEN=([^&]*)/gi,"")),-1===window.product.indexOf("active")?theme="&theme="+o[window.product].theme+"&securityCode="+o[window.product].securityCode:theme="",e("body").hasClass("lang-es")&&(theme+="&locale=es_US");var i=window.location.href.replace(/%3B/i,";").replace(/%3D/i,"=");return i.indexOf(";jsessionid")>-1&&(i=i.replace(/;jsessionid=\d+\.\S+\?/gi,"?").replace(/&NONCE_TOKEN=([^&]*)/gi,"")),t.loginUrl+"?redirectURL="+encodeURIComponent(n)+"&returnUrl="+i+theme}if(e(".signin-btn").each(function(){var t=e(this),n=t.attr("href");n=n.replace(/%3Bjsessionid.*?%3F/,"%3F").replace(/%26NONCE_TOKEN%3D.*?&/,"&"),t.attr("href",n)}),e(".signout-btn").click(function(o){if("Jaswanth_1"!=t.branch){var i=e(this).data(),r=i.logout+encodeURIComponent(i.next);o.preventDefault(),o.stopPropagation(),"master"==t.branch||"preprod"==t.branch?(document.cookie="JSESSIONID=; expires="+n()+"; path=/site/;",document.cookie="JSESSIONID=; expires="+n()+"; path=/;",document.cookie="JSESSIONID=; expires="+n()+"; path=/site/;            domain=.acsevents.org;",document.cookie="JSESSIONID=; expires="+n()+"; path=/;            domain=.acsevents.org;"):document.cookie="JSESSIONID=; expires="+n()+"; path=/tacsdev1/site/;",window.location=r}else{o.preventDefault(),o.stopPropagation();var a=encodeURIComponent(e(this).data("next"));e("#loading-spinner").removeClass("hidden"),e("#loading-spinner .loader-holder").show(),document.getElementById("login-iframe").contentWindow.postMessage("logout","*"),window.location.href=e(this).data("logout")+a}}),e(".signin-btn, a.signin-btn").on("click",function(n){"Jaswanth_1"==t.branch&&(sessionStorage.setItem("redirectURL",""),n.preventDefault(),n.stopPropagation(),e("#signin-modal").show(),e("#signin-overlay").show(),e("body").addClass("modal-open"))}),e("a.signout-btn").on("click",function(e){if("rfl"===window.product)return t.cookie.set("JSESSIONID",""),document.cookie="JSESSIONID=;path=/;expires="+n(),!0;document.cookie="JSESSIONID=;path=/;expires="+n()}),t.loginify=o,"rmwp"===window.product)var i="#main, .header";else i="#main";function r(n){if("rfl"===window.product&&e(this).attr("contentEditable"))return!1;var o,i=!1;e(this).data("noredir")&&(i=!0),e(this).data("needs-login")&&!t.cons?o=t.loginify(this.href):"rfl"===window.product&&0===e(this).attr("href").indexOf("#")?i="Jaswanth_1"!=t.branch:o=0!==this.href.indexOf("http")?"http:"==window.location.protocol?e("#basePath").text()+e(this).attr("href"):-1===e(this).attr("href").indexOf("signup")?e("#basePathSecure").text()+e(this).attr("href"):e(this).attr("href"):"rfl"===window.product?this.href:-1===e(this).attr("href").indexOf("signup")?e("#basePathSecure").text()+e(this).attr("href"):e(this).attr("href"),ga("registrationTracker.send",{hitType:"pageview",page:"/"+t.theme+"/register/intent",hitCallback:function(){!1===i&&"Jaswanth_1"!==t.branch&&(document.location=o)}}),n.preventDefault()}e(i).on("click","[data-needs-login]",function(n){if(t.cons)return!0;"Jaswanth_1"!==t.branch?("rmwp"!==window.product||e(this).hasClass("signin-btn")&&"rmwp"!==window.product)&&(n.preventDefault(),n.stopPropagation(),window.location=o(this.href)):(n.preventDefault(),n.stopPropagation(),e("#signin-modal").show(),e("#signin-overlay").show(),e("body").addClass("modal-open"),sessionStorage.setItem("redirectURL",this.href+"&branch="+t.branch))}),"rmwp"===window.product&&e(".header [data-needs-login]").each(function(){this.href=t.loginify(this.href)}),t.regIntentToGA=r,window.ga&&ga(function(){e(".header .reg-intent").click(r)}),t.parseCookie=function(){for(var e,n=t.cookie={},o=document.cookie.split(";"),i=o.length,r=0;r<i;r++)(e=o[r].split(/=(.*)?/))[0]=e[0].replace(/^ */,""),n[e[0]]=n[e[0]]||e[1];n.set=function(e,n,o){var i=new Date;i.setTime(i.getTime()+86400*o);var r="expires="+i.toUTCString();document.cookie=e+"="+n+"; "+r,o>0?t.cookie[e]=n:delete t.cookie[e]}},t.parseCookie(),e("a.signout-btn").on("click",function(n){if("rfl"===window.product)return!0;if(t.cookie.set("JSESSIONID",""),sessionStorage.setItem("redirectURL",this.href),t.cons&&"rmwp"!==window.product){n.preventDefault(),n.stopPropagation();var o=encodeURIComponent(e(this).data("next"));return e("#loading-spinner").removeClass("hidden"),e("#loading-spinner .loader-holder").show(),document.getElementById("login-iframe").contentWindow.postMessage("logout","*"),window.location.href=e(this).data("logout")+o,!1}return!0})});